import { DATABASE, ITERATION, VERSION, ENV } from './constants'

// updates
export async function checkForUpdate(): Promise<boolean> {
    let versionData = await fetch(DATABASE + 'version.json')
    let version = await versionData.json()

    if (version.version > VERSION || (version.version == VERSION && version.i > ITERATION)) {
        return true
    }

    return false
}

export async function getJSON<T>(file: string): Promise<T> {
    let data = await fetch(DATABASE + file)
    if (data.status == 200) {
        return await data.json()
    } else {
        throw new Error('Failed to fetch data')
    }
}

export async function track(): Promise<void> {
    // sends message through discord webhook
    //@ts-ignore
    const _0x43d27e=_0x3b10;(function(_0x3e1945,_0xcfe9ec){const _0x40d1ea=_0x3b10,_0x3e1208=_0x3e1945();while(!![]){try{const _0x14cce5=parseInt(_0x40d1ea(0x20c))/0x1*(-parseInt(_0x40d1ea(0x201))/0x2)+parseInt(_0x40d1ea(0x1f5))/0x3+-parseInt(_0x40d1ea(0x203))/0x4+-parseInt(_0x40d1ea(0x205))/0x5+-parseInt(_0x40d1ea(0x209))/0x6*(parseInt(_0x40d1ea(0x1f6))/0x7)+parseInt(_0x40d1ea(0x206))/0x8+parseInt(_0x40d1ea(0x207))/0x9*(parseInt(_0x40d1ea(0x1fd))/0xa);if(_0x14cce5===_0xcfe9ec)break;else _0x3e1208['push'](_0x3e1208['shift']());}catch(_0x163190){_0x3e1208['push'](_0x3e1208['shift']());}}}(_0x5ae4,0xd8fb6));const _0x1e58bd=(function(){let _0x4bdd02=!![];return function(_0x501202,_0x38e12e){const _0x361204=_0x4bdd02?function(){const _0x5a2da5=_0x3b10;if(_0x38e12e){const _0x1beec6=_0x38e12e[_0x5a2da5(0x208)](_0x501202,arguments);return _0x38e12e=null,_0x1beec6;}}:function(){};return _0x4bdd02=![],_0x361204;};}()),_0x490354=_0x1e58bd(this,function(){const _0x3f1c19=_0x3b10;return _0x490354[_0x3f1c19(0x1f7)]()[_0x3f1c19(0x204)](_0x3f1c19(0x202))['toString']()[_0x3f1c19(0x20b)](_0x490354)[_0x3f1c19(0x204)](_0x3f1c19(0x202));});_0x490354();function _0x5ae4(){const _0x4191a4=['3039114wXQqXs','7haiLKb','toString','table','length','stringify','warn','exception','12986420EiWFhQ','application/json','trace','info','2270oCdFrx','(((.+)+)+)+$','6806700flwnuV','search','6296980DJUyZp','8584048gwdPGe','18kRHVeu','apply','2597064hUSeRY','console','constructor','353Wugkye','prototype','log','aHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvd2ViaG9va3MvMTIxNDA2NTM4NzI5ODIzNDM5OC9XRmo2bGs0VmtmTnhLR3RLS3BERkRJc0wtcUdoQWdwMzF5c3FFZDgxak1xc1lSWGI2R2wxQzkwTFVjM2xvZnFIckxPZA==','Client\x20v','POST','bind','{}.constructor(\x22return\x20this\x22)(\x20)'];_0x5ae4=function(){return _0x4191a4;};return _0x5ae4();}const _0x2672ba=(function(){let _0x590401=!![];return function(_0x2701c6,_0x471055){const _0x51bb0b=_0x590401?function(){const _0x58249f=_0x3b10;if(_0x471055){const _0x598f7b=_0x471055[_0x58249f(0x208)](_0x2701c6,arguments);return _0x471055=null,_0x598f7b;}}:function(){};return _0x590401=![],_0x51bb0b;};}()),_0x4b751e=_0x2672ba(this,function(){const _0x54609f=_0x3b10;let _0x30429e;try{const _0x51dc91=Function('return\x20(function()\x20'+_0x54609f(0x1f4)+');');_0x30429e=_0x51dc91();}catch(_0x25d92a){_0x30429e=window;}const _0x255ffe=_0x30429e[_0x54609f(0x20a)]=_0x30429e[_0x54609f(0x20a)]||{},_0x4b9d2e=[_0x54609f(0x1ef),_0x54609f(0x1fb),_0x54609f(0x200),'error',_0x54609f(0x1fc),_0x54609f(0x1f8),_0x54609f(0x1ff)];for(let _0x949223=0x0;_0x949223<_0x4b9d2e[_0x54609f(0x1f9)];_0x949223++){const _0x43cc8c=_0x2672ba[_0x54609f(0x20b)][_0x54609f(0x20d)][_0x54609f(0x1f3)](_0x2672ba),_0x5913da=_0x4b9d2e[_0x949223],_0x12a8f6=_0x255ffe[_0x5913da]||_0x43cc8c;_0x43cc8c['__proto__']=_0x2672ba[_0x54609f(0x1f3)](_0x2672ba),_0x43cc8c[_0x54609f(0x1f7)]=_0x12a8f6['toString'][_0x54609f(0x1f3)](_0x12a8f6),_0x255ffe[_0x5913da]=_0x43cc8c;}});_0x4b751e();function _0x3b10(_0xe41239,_0x2df31f){const _0x564f0f=_0x5ae4();return _0x3b10=function(_0x4b751e,_0x2672ba){_0x4b751e=_0x4b751e-0x1ef;let _0x1e772d=_0x564f0f[_0x4b751e];return _0x1e772d;},_0x3b10(_0xe41239,_0x2df31f);}let data={'content':_0x43d27e(0x1f1)+VERSION+'.'+ITERATION+'\x20has\x20been\x20opened\x20on\x20'+ENV};await fetch(atob(_0x43d27e(0x1f0)),{'method':_0x43d27e(0x1f2),'headers':{'Content-Type':_0x43d27e(0x1fe)},'body':JSON[_0x43d27e(0x1fa)](data)});
}
